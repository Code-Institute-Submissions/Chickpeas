{% extends 'base.html'%} {% block content %}
<main class="container addRecipe">
  <h1>Create Recipe</h1>
  <form action="{{ url_for('insert_recipe') }}" method="POST">
    <div class="form-group">
      <label for="recipe_name">Recipe Name</label>
      <input
        type="text"
        class="form-control"
        id="recipe_name"
        name="recipe_name"
        placeholder="Name your recipe."
      />
    </div>
    <div class="form-group">
      <label for="meal_type">Meal Category</label>
      <select class="form-control" id="meal_type" name="meal_type">
        <option>Breakfast</option>
        <option>Lunch</option>
        <option>Dinner</option>
        <option>Dessert</option>
      </select>
    </div>
    <div class="form-group">
      <label for="recipe_description">Recipe Description</label>
      <textarea
        class="form-control"
        id="recipe_description"
        rows="3"
        name="recipe_description"
      ></textarea>
    </div>
    <div class="form-group">
      Recipe Image
    </div>
    <div class="form-group">
      <label for="recipe_image">Add Recipe Image</label>
      <input type="file" class="form-control-file" id="recipe_pic_url" />
      <div class="form-group">
        <input
          type="text"
          class="form-control"
          id="recipe_image_link"
          name="recipe_pic_url"
          placeholder="Image Link"
        />
      </div>
    </div>
    <!--Add radio btn with option to upload link to image-->
    <h3>Add Ingredients</h3>
    <div class="row">
      <select class="ingredient_select" id="ingredient_select" required>
        {% for ing_name in ingredients %}
        <option>{{ing_name.name}}</option>
        {% endfor %}
      </select>
      <label for="ingredient_measurement">Measurement</label>
      <input
        type="text"
        class="form-control"
        id="ingredient_measurement"
        name="ingredient_measurement"
        placeholder="ex. 200g, 1/2cup, 2dl"
        required
      />
      <label for="ingredient_comment">Comment</label>
      <input
        type="text"
        class="form-control"
        id="ingredient_comment"
        name="ingredient_comment"
        placeholder="ex. Use fresh."
      />
      <button type="button" onclick="addToIngredientList()">
        <i class="fas fa-plus-circle"></i>Add Ingredient
      </button>
    </div>

    <ul class="list-group form-group" id="recipe_ingredient_list">
      <li class="list-group-item"></li>
    </ul>
    <div class="form-group">
      <label for="recipe_instructions">Recipe Instructions</label>
      <textarea
        class="form-control"
        id="recipe_instructions"
        name="recipe_instructions"
        rows="3"
      ></textarea>
    </div>
    <button type="submit" class="btn btn-primary">
      Create Recipe
    </button>
  </form>
</main>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"
></script>
<script>
  var selectedIngredient;
  $("select.ingredient_select").change(function () {
    selectedIngredient = $(this).children("option:selected").val();
    alert("You have selected the country - " + selectedIngredient);
  });
  var ingredient_index = 1;
  function addToIngredientList() {
    if (!!selectedIngredient) {
      var ingredient_measurement = $("#ingredient_measurement").val();
      var commentlines = "";
      var ingredient_comment = $("#ingredient_comment").val();
      if (!!ingredient_comment) {
        commentlines = "---";
      } else {
        commentlines = "";
      }
      $("#recipe_ingredient_list").append(
        `<li type="text" readonly class="list-group-item"><input type="text" readonly name="recipe_ingredient_id_${ingredient_index}" value="${ingredient_measurement} ${selectedIngredient} ${commentlines} ${ingredient_comment}"><button type="button" onclick="removeLI()" class="badge badge-primary badge-pill right delete">Remove</button></li>`
      );
      ingredient_index++;
    }
  }
  function removeLI() {
    $(".delete").on("click", function () {
      $(this).parent().remove();
    });
    console.log(this);
    console.log("function working");
  }
</script>
{% endblock %}
